## 1. Извлечение отношений и построение графа

**Что это?**  
Мы берём текст новости и ищем не только имена (например, "Илон Маск", "Tesla", "SpaceX"), но и **связи между ними**: кто с кем встретился, кто кого нанял, кто кого купил и т.д.

**Как это делается?**

- Сначала выделяются **именованные сущности** с помощью NER (например, "Apple", "OpenAI").
    
- Затем из предложений извлекаются **действия или отношения** между этими сущностями. Это может быть:
    
    - `(Илон Маск, основал, SpaceX)`
        
    - `(Tesla, купила, компанию)`
        
    - `(Илон Маск, выступил, на конференции)`
        
- Эти тройки записываются как **"Субъект – Действие – Объект"**.
    

**Какие инструменты?**

- **OpenIE** (Open Information Extraction) — готовые библиотеки для автоматического извлечения таких связей из текста.
    
- **SpaCy + Dependency Parser** — можно использовать зависимости между словами, чтобы вручную находить отношения.
    

**Зачем граф?**

- Мы делаем **граф**, где:
    
    - **узлы** — это сущности (Илон Маск, Tesla, Apple),
        
    - **рёбра (связи)** — это действия (основал, купил, встретился).
        
- Такой граф позволяет наглядно видеть, как сущности связаны, даже если они не упомянуты рядом.
    

**Пример:**

```
Текст: "Илон Маск основал SpaceX и Tesla."
→ Граф:
Илон Маск —[основал]→ SpaceX
Илон Маск —[основал]→ Tesla
```

---

## 2. Метрики связности и важности

**Что это?**  
После построения графа надо понять: **какие связи важные**, а какие — просто фон.

**Почему это важно?**  
Иногда люди просто **встретились в кафе** — это не очень важно. А иногда — **обсудили слияние компаний**. Мы хотим оставить только значимые связи.

**Какие есть признаки "важности" связи?**

### Частота совместных упоминаний

- Чем **чаще** две сущности встречаются вместе в статьях, тем более вероятна важная связь.
    
- Например, "Илон Маск" и "Tesla" встречаются в 80% статей вместе — сильная связь.
    

### Позиция и количество упоминаний

- Если сущность упомянута **в начале** статьи и **несколько раз** — она, скорее всего, **основная тема**.
    
- Если встречается один раз ближе к концу — скорее всего, **второстепенная**.
    

### Семантическое сходство

- Мы смотрим, насколько **описания сущностей похожи**. Например:
    
    - "Tesla" и "Lucid Motors" обе описываются как "автопроизводитель".
        
    - Это может быть признаком **конкуренции**.
        

### Онтологическая близость

- Если две сущности находятся **близко друг к другу в базе знаний** (например, Wikidata), это также указывает на возможную важную связь.
    

### Методы:

- **Cosine Similarity** — сравнение описаний сущностей как текстов.
    
- **Co-occurrence Matrix** — считаем, сколько раз две сущности встречаются вместе.
    
- **Graph Centrality / Betweenness** — важные узлы часто находятся **в центре** графа.
    

---

## 3. Графовые модели и машинное обучение

**Что это?**  
Когда у нас есть **граф всех сущностей и их связей**, мы можем использовать **графовые нейросети (GNN)** или другие модели машинного обучения, чтобы **автоматически понять**, какие связи важные.

---

### Как работает?

1. **Каждой сущности присваивается вектор (эмбеддинг)**, который описывает её свойства.
    
2. Эти вектора **обмениваются информацией** с соседними узлами.
    
3. Модель **обучается** на размеченных примерах:
    
    - Это важная связь → 1
        
    - Это неважная → 0
        
4. После обучения модель может **предсказывать** важность любой новой связи.
    

---

### Какие бывают графовые модели?

- **GNN (Graph Neural Networks)** — самая современная техника. Каждый узел «смотрит» на соседей и обновляет свою информацию.
    
- **Graph Attention Networks (GAT)** — улучшенная версия, где узлы **внимательнее относятся к некоторым соседям**, чем к другим.
    
- **Node2Vec / DeepWalk** — делают «прогулки» по графу, чтобы учиться структуре и связям.
    
- **Relational GCN** — учитывают тип связи (например, "работает на", "конкурирует с").
    

---

### Применение:

- Оценка **важности событий**
    
- Фильтрация **новостного шума**
    
- Построение **динамического графа связей между компаниями и людьми**
    
- **Автоматическая аннотация** новостей и выявление скрытых структур


| Шаг                               | Что делает                                  | Инструменты / Методы                            |
| --------------------------------- | ------------------------------------------- | ----------------------------------------------- |
| **1. Извлечение отношений (NER)** | Выделяет кто с кем взаимодействует в тексте | OpenIE, spaCy, Relation Extraction              |
| **2. Построение графа**           | Строит схему сущностей и их связей          | NetworkX, Neo4j                                 |
| **3. Метрики важности**           | Оценивает значимость каждой связи           | Co-occurrence, Cosine Similarity, Graph Metrics |
| **4. Графовые модели**            | Обучаются находить важные связи             | GNN, Node2Vec, GAT                              |
